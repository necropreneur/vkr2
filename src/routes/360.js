if (typeof lang == "undefined") var lang = "ro";
if (lang == "ro") {
  var descopera = "Descoperă...";
  var catre = "Către: ";
  var muzeu_name = "Muzeul BNR";
  var marmura_name = "Holul de Marmură";
  var hol_name = "Holul de legătură";
  var muzeu_link = "http://www.bnr.ro/apage.aspx?pid=13714";
  var hol_link = "http://www.bnr.ro/apage.aspx?pid=13715";
  var cap = {
    p1: "Probă monetară <strong>20 de lei</strong> din <strong>1868</strong>. Reprezintă prima încercare de a emite o monedă românească din aur. Titulatura „Domnul Românilor” („Domnulu Româniloru”) și reprezentarea efigiei domnitorului pe avers au fost de neacceptat pentru cele trei imperii de la granița României. Din acest motiv, moneda nu a mai fost pusă în circulație.",
    p2: "Inaugurarea Monetăriei Statului în București, la 24 februarie <strong>1870</strong>, aduce în circulație primele monede din aur (<strong>20 de lei</strong>) și argint (<strong>1 leu</strong>). Moneda de 1 leu este prima pe care apare numele monedei naționale. Deși emise într-un tiraj mic, cele două monede afirmau în fața străinătății hotărârea României de a-și valorifica dreptul suveran de a emite monedă proprie.",
    p3: "Medalii din aur: <strong>„Carol I – 1866”</strong> și Medalia <strong>Cadrilaterului</strong>. Medalia „Carol I - 1866” a fost realizată în numai 100 de exemplare și folosită de prinț ca decorație până la instituirea Ordinului „Steaua României”. Medalia Cadrilaterului, emisă de asemenea în argint și bronz, a fost realizată în 1913 și marchează participarea României la al doilea război balcanic.",
    p4: "Monedă argint <strong>5 lei</strong> din <strong>1880</strong>, anul în care apare Legea pentru înființarea unei „bănci de scompt și circulațiune” - actul de naștere al Băncii Naționale a României. Fabricată din argintul rezultat din topirea rublelor intrate în țară în timpul războiului, moneda de 5 lei a fost bătută la Monetăria Statului, reutilată și modernizată.",
    p5: "Medalia jubiliară <strong>„Ardealul Nostru”</strong>, cunoscută și sub denumirea populară de „cocoșel” (avea reprezentat pe revers cocoșul galic), a fost bătută în anul <strong>1944</strong>, într-un tiraj de un milion de exemplare, fiind emisă în cadrul Împrumutului Refacerii Naționale. Deși nu are gravată nicio valoare nominală, piesa se aliniază sistemului monetar european, prezentând aproape toate caracteristicile monedelor franțuzești de 20 franci.",
    p6: "Odată cu instaurarea puterii comuniste, a fost întreruptă tradiția BNR privind emiterea de monede jubiliare sau comemorative. Excepțiile le-au constituit emisiunile din aur și argint, din 1948 și din anii <strong>1982-1983</strong>, prin care se dorea marcarea unei aniversări discutabile din punct de vedere istoric: „2.050 de ani de la crearea <strong>statului dac</strong> centralizat și independent”.",
    p7: "După cel de-al Doilea Război Mondial, România a cunoscut o inflație galopantă. Pentru a absorbi o parte din masa monetară, în <strong>1946</strong>, s-a emis o monedă din argint de <strong>25.000 de lei</strong>, în greutate de 25 grame. În condițiile deprecierii rapide a leului, moneda este emisă cu greutatea redusă la jumătate și o nouă monedă cu greutatea inițială este pusă în circulație ulterior, având valoarea nominală de <strong>100.000 de lei</strong> - cea mai mari valoare nominală pentru o monedă românească. În 1947 a fost pusă în circulație bancnota de 5.000.000 de lei, cea mai mare denominare din istorie.",
    p8: "Proiectul emisiunii unei monede naționale datează din timpul lui Alexandru Ioan Cuza. După modelul francului francez, s-a propus numele de „român“ și s-a negociat finanțarea emisiunii din partea unor bănci de la Paris. În anul <strong>1860</strong>, a fost propus un alt nume, acela de „romanat“, monedă care era împărțită în „decime“ sau „bani“ (a zecea parte dintr-un romanat) și „centime“ sau „bănișori“ (a suta parte dintr-un romanat). Intențiile guvernului român nu au fost însă finalizate, în absența unei susțineri ferme din partea împăratului Napoleon III, care nu dorea un conflict diplomatic cu Imperiul Otoman. În anul 2007, Banca Națională a României a materializat aceste proiecte, prin punerea în circulație a unui set de trei medalii, care reproduc desenele din 1860 pentru piesele de <strong>20 români, 5 români și 10 centime</strong>.",
    s1: "În <strong>1906</strong> se împlineau <strong>40 ani de domnie a lui Carol I</strong> și 25 ani de la proclamarea Regatului României. Pentru a marca aceste evenimente, a fost comandată la Monetăria Regală a Belgiei o emisiune numismatică formată din cinci monede din aur. Moneda de 12,5 lei este singura monedă românească de aur cu valoare fracționată.",
    s2: "Monedele care compun această emisiune aniversară sunt singurele pe care apare efigia Regelui Ferdinand I. Deși pe monede apare gravat anul <strong>1922</strong>, emisiunea a fost aprobată în anul 1927, la împlinirea a <strong>cinci ani de la încoronarea Regelui Ferdinand I și a reginei Maria la Alba Iulia</strong>. Emisiunea a fost realizată la Monetăria Regală Britanică, aurul fiind furnizat de Banca Națională a României din lingourile aflate în tezaurul său.",
    s3: "Emisiunea jubiliară <strong>„Centenarul nașterii Regelui Carol I” (1939)</strong> cuprinde trei valori: 20 și 100 de lei (în câte două variante, conform dorinței Regelui Carol al II-lea), dar și o piesă mare, cu diametrul de 41 mm și greutatea de 42 grame, echivalentul a 12 ducați și denumită „galben de podoabă”. Interesant este faptul că emisiunea nu a avut un caracter oficial, fiind oferită de Carol al II-lea doar apropiaților săi și unor înalți demnitari ai statului (aproximativ 50 kg de aur fin). Realizate la Monetăria Națională din București, sunt primele monede din aur executate după proiectele unui gravor român.",
    s4: "Emisiunea aniversară <strong>„10 ani de glorioasă domnie a regelui Carol al II-lea”</strong> a fost realizată în anul <strong>1940</strong> și este o oglindă aproape identică a emisiunii din 1939: două variante de monede de 20 și 100 de lei, precum și galbenul de podoabă. Din cauza tirajului mic (500 exemplare per variantă), acestea sunt printre cele mai rare și mai valoroase monede românești.",
    t1: "<strong>Tezaurul</strong> descoperit în <strong>Bucovina</strong> este alcătuit din monede dacice de tip Huși-Vovriești. Caracteristica principală a acestor monede, datând din secolul al III-lea î.Chr., este prezența tăieturilor de pe revers.",
    t2: "<strong>Tezaurul</strong> de la <strong>Deva</strong> a fost descoperit în 1973 și este compus din peste 3.000 de monede din argint și 22 de monede din aur. Din acest tezaur, Muzeul BNR deține monedele din aur datate din secolul al XVI-lea și emise de diverse state europene și de Imperiul Otoman.",
    t3: "<strong>Tezaurul Dobrogea</strong> - cele mai vechi monede din argint bătute pe teritoriul României, emise în secolul al V-lea î.Chr. la Histria, important centru comercial de pe coasta de vest a Mării Negre. Zona de circulație a monedelor histriene era foarte extinsă, de la Munții Balcani până Nistru, acoperind largi teritorii din nord-estul Bulgariei, estul Munteniei, sudul Moldovei și Ucrainei. Tezaurul a fost descoperit în împrejurimile Mănăstirii Cocoș (județul Tulcea) și este alcătuit din 200 de monede, datate din secolele IV-III î.Chr.",
    t4: "<strong>Tezaurul</strong> de la <strong>Galați</strong> este format din 92 de taleri-leu, strămoșul monedei noastre naționale. Emis pentru prima oară în 1575, în provincia Olandă a Țărilor de Jos, având reprezentat pe revers un leu rampant (ridicat pe labele din spate), <em>Leeuwendaalder</em> (talerul-leu sau leul) a devenit cea mai frecvent folosită monedă de argint cu valoare ridicată, nu numai în țările Române, ci în întreaga Peninsulă Balcanică. Răspândit în America de coloniștii olandezi, talerul-leu a dus la apariția denumirii de dolar prin transformarea fonetică <em>daaldler - dollar.</em>",
    t5: "<strong>Tezaurul</strong> de la <strong>Pelișor</strong> (județul Sibiu) este compus din peste 1.000 de monede din aur și argint din secolul al XIV-lea. Tezaurul include monede emise de Sigismund de Luxemburg și Maria de Anjou, ducați venețieni și de proveniență germană, precum și un ducat bătut în Țara Românească, în prima parte a domniei lui Mircea cel Bătrân, care atestă legăturile dintre Țara Românească și Transilvania.",
  };
} else {
  var descopera = "Discover...";
  var catre = "To the ";
  var muzeu_name = "NBR Museum";
  var marmura_name = "Marble Hallway";
  var hol_name = "Mini Hallway";
  var muzeu_link = "http://www.bnr.ro/apage.aspx?pid=13836";
  var hol_link = "http://www.bnr.ro/apage.aspx?pid=13837";
  var cap = {
    p1: "<strong>20 lei 1868</strong> Coin Pattern. It is the first attempt to issue a Romanian gold coin. The inscription “Domnul Românilor” (“Prince of the Romanians”) and the ruler’s effigy on the obverse were unacceptable for the three empires surrounding Romania. Therefore, the coin was never put into circulation.",
    p2: "The inuaguration of the State Mint on 24 February<strong>1870</strong> coincides with minting of the first gold and silver coins (<strong>20 de lei</strong> and <strong>1 leu</strong>). The 1 leu coin is the first bearing the name of the national currency. Although they were minted in small quantities, the two issues asserted Romania’s determination to exercise its sovereign right to issue its own currency.",
    p3: "The “Carol I - 1866” medal had a mintage of only 100 pieces and was used by Prince Carol I as a decoration until the establishment of the “Star of Romania” Order. “The Southern Dobruja” medal, which was also issued in silver and bronze starting 1913, commemorates Romania’s participation in the Second Balkan War.",
    p4: "<strong>5 lei</strong> silver coin from <strong>1880</strong>, the year when the National Bank of Romania was born, by the law on the establishment of a ‘discount and circulation bank’. The new coin, minted from the silver obtained by melting the rubles that had entered the country during the war, was produced at the State Mint that had been refurbished and modernized.",
    p5: "The <strong>“Our Transylvania”</strong> Jubilee Metal, informally known as “The Little Rooster” (because it had the Gallic rooster on the reverse) was minted in <strong>1944</strong> in 1,000,000 pieces, as part of the Loan for National Reconstruction. Even though it does not hold any nominal value, the medal features almost all of the characteristics of the French 20 francs coin.",
    p6: "After the communists came to power, the National Bank of Romania no longer issued commemorative coins was interrupted. The only exceptions were in 1948 and the <strong>1982-1983</strong> gold and silver coins marking a historically debatable anniversary - ‘2,050 years since the establishment of the centralised and independent <strong>Dacian state</strong>’.",
    p7: "After World War II, Romania went through a period of galloping inflation. To absorb part of the money on the market, a <strong>25,000 lei</strong> silver coin weighing 25 grams was issued in 1946. Given the rapid depreciation of the national currency, the coin was reissued with its weight reduced by half and later, a new coin with the initial weight and a face value of <strong>100,000 lei</strong> - the highest denomination for Romanian coins - was put into circulation. In 1947, the 5,000,000 lei banknote was issued, the highest face value in Romania’s monetary history.",
    p8: "The idea of issuing national currency dates back to Alexandru Ioan Cuza. The suggested name for the currency was <em>român (Romanian) ,</em> after the French model of the franc. Negotiations for financing the minting were conducted with several banks in Paris. In <strong>1860</strong>, a new name was proposed: <em>romanat,</em> divided into 10 <em>decime</em> or <em>bani,</em> which in turn were each divided into 10 <em>centime</em> or <em>bănișori.</em> However, the intentions of the Romanian government failed to materialize in the absence of a firm support from Emperor Napoleon III, who sought to avoid any diplomatic conflicts with the Ottoman Empire. In 2007, the National Bank of Romania materialized these projects by putting into circulation a set of three medals reproducing the 1860 designs made for the <strong>20 români, 5 români and 10 centime</strong> coins.",
    s1: "<strong>1906 marked the 40<sup>th</sup> anniversary of <strong>King Carol I (Charles&apos;) reign</strong> and 25 years since the proclamation of the Kingdom of Romania. To mark these events, a monetary issue of five gold coins was ordered at the Royal Mint of Belgium. The 12.5 lei coin is the only Romanian gold coin with fractional face value.",
    s2: "The coins in this anniversary issue are the only ones with the effigy of King Ferdinand I. Although the year <strong>1922</strong> is engraved on the coins, the issue was approved in 1927, on the occasion of the <sup>fifth celebration of the coronation of King Ferdinand and Queen Marie at Alba-Iulia</strong>. The issue was minted at the British Royal Mint with gold provided by the National Bank of Romania.",
    s3: "The anniversary issue <strong>“One Hundred Years since the Birth of King Carol I” (1939)</strong> includes three types of coins: 20 lei, 100 lei (with two different designs, acoording to King Carol II's wishes), as well as a large piece, 41 mm in diameter and weighing 42 grams, the equivalent of 12 ducats, also known as the “Jewelry Guilder”. An interesting fact: this issue did not serve an official purpose; King Carol II only offered it to people close to him and to several high ranking civil servants (approximately 50 kg of fine gold). Struck at the National Mint in Bucharest, these are the first gold coins designed by a Romanian engraver.",
    s4: "The anniversary issue <strong>“Ten Years of the Glorious Reign of King Carol II”</strong> was minted in <strong>1940</strong> and is nearly identical to the one of 1939: 2 versions of the 20 lei and 100 lei gold coins and the “Jewelry Guilder”. Due to its small mintage (500 pieces per type), these gold coins are among the rarest and most valuable Romanian coins.",
    t1: "The <strong>Hoard</strong> found in <strong>Bucovina</strong> consists of third century Dacian Huși-Vovriești coins, that stand out thanks to the transerve cuts on the reverse",
    t2: "The <strong>Deva Hoard</strong> was discovered in 1973 and contains over 3,000 silver and 22 gold coins. From this cache, the NBR Museum owns the 16<sup>th</sup> centrury gold coins issued by various European states and the Ottoman Empire.",
    t3: "The <strong>Dobrogea Hoard</strong> - the oldest silver coins ever to be minted in present-day Romania. They were issued in the fifth century B.C. in Histria, and important commercial hub on the West coast of the Black Sea. Histrian coins circulated from the Balkans to the Dnister river, spanning large sections of North-East Bulgaria, Eastern Wallachia, Southern Moldavia and Ukraine. The hoard was discovered near Cocoș Monastery, Tulcea, and consists of 200 coins from the fourth and third centuries B.C.",
    t4: "The <strong>Galați Hoard</strong> contains 92 de lion-thaler pieces, the ancestor of the modern day <em>leu (lion).</em> First issued in 1575 in the Holland province of The Netherlands and depicting a rampant lion (standing on its back feet), the <em>Leeuwendaalder(the lion-thaler or simply the lion) became the most frequently used high-value silver coin not only in the Romanian principalities, but also throughout the Balkan Peninsula. Also spread in America by Dutch collonists, the lion-thaler was the basis behind the US dollar, through the phonetic <em>daaldler - dollar</em> transformation.",
    t5: "The <strong>Pelișor Hoard</strong>, Sibiu, has over 1,000 gold and silver coins from the 14<sup>th</sup> century, including pieces issued by Sigismund of Luxembourg and Marie of Anjou, Venetian and German ducats, as well as a ducat struck in Wallachia, during the reign of Mircea the Elder. The presence of the latter in a hoard discovered in Transylvania confirms the economical ties between the two countries.",
  };
}
var fbtrans = {
  en: {
    CLOSE: "Close",
    NEXT: "Next",
    PREV: "Previous",
    ERROR: "Error loading content.",
    PLAY_START: "Start slideshow",
    PLAY_STOP: "Pause slideshow",
    FULL_SCREEN: "Full screen",
    THUMBS: "Thumbnails",
    ZOOM: "Zoom",
  },
  ro: {
    CLOSE: "Închide",
    NEXT: "Înainte",
    PREV: "Înapoi",
    ERROR: "Eroare încărcare conținut",
    PLAY_START: "Începe slideshow",
    PLAY_STOP: "Pauză slideshow",
    FULL_SCREEN: "Întreg ecranul",
    THUMBS: "Pictograme",
    ZOOM: "Mărește/ micșorează",
  },
};

var go = false;
var canvas = document.createElement("canvas");
var gl = canvas.getContext("webgl") || canvas.getContext("experimental-webgl");
if (gl && gl instanceof WebGLRenderingContext) go = true;
else go = false;
if (go == false) {
  if (lang == "ro")
    $("#gl-msg")
      .html(
        'Browser-ul nu este compatibil WebGL. <a href="https://get.webgl.org" target="_blank">Mai multe informații</a>'
      )
      .fadeIn();
  else
    $("#gl-msg")
      .html(
        'Your browser does not support WebGL. <a href="https://get.webgl.org" target="_blank">More information</a>'
      )
      .fadeIn();
  $("#intro-msg h2").hide();
}

$("#svg_muzeu").children("circle").css("animation", "pulse 2s infinite linear");

var panorama_muzeu,
  panorama_marmura,
  panorama_hol,
  viewer,
  progress,
  progressElement,
  infospot_muzeu_info,
  infospot_muzeu_2_marmura,
  infospot_muzeu_link,
  infospot_muzeu_misc,
  infospot_marmura_info,
  infospot_marmura_2_muzeu,
  infospot_marmura_2_hol,
  infospot_marmura_misc,
  infospot_hol_info,
  infospot_hol_2_marmura,
  infospot_hol_link,
  infospot_hol_misc;

progressElement = document.getElementById("progress");
function onEnter(event) {
  progressElement.style.width = 0;
  progressElement.classList.remove("finish");
  $("#map a").css("pointer-events", "none");
}
function onProgress(event) {
  progress = (event.progress.loaded / event.progress.total) * 100;
  progressElement.style.width = progress + "%";
  $("canvas").css("opacity", 0.6);
  if (progress === 100) {
    progressElement.classList.add("finish");
    $("#intro-msg").fadeOut(1000);
    $("canvas").animate({
      opacity: 1,
    });
  }
}
function onLoad(event) {
  $("canvas").css("opacity", 1);
  $("#map a").css("pointer-events", "auto");
}
function onLeave(event) {
  if (is_touch_device()) $("#map").fadeOut(750);
  setTimeout(function () {
    $("#map a").css("pointer-events", "auto");
  }, 800);
}

infospot_muzeu_info = new PANOLENS.Infospot(512, "css/ico/info.png");
infospot_muzeu_info.position.set(-4205.86, 102.82, -2683.95);
infospot_muzeu_info.addHoverElement(
  document.getElementById("muzeu_desc"),
  -175
);
infospot_muzeu_info.setCursorHoverStyle("help");

infospot_muzeu_link = new PANOLENS.Infospot(512, "css/ico/info.png");
infospot_muzeu_link.position.set(148.41, 54.74, -4990.07);f
infospot_muzeu_link.addHoverElement(document.getElementById("muzeu_link"), 0);
infospot_muzeu_link.setCursorHoverStyle("pointer");
infospot_muzeu_link.addEventListener("click", function () {
  setTimeout(function () {
    window.open(muzeu_link);
  }, 1000);
});

infospot_muzeu_misc = new PANOLENS.Infospot(512, "css/ico/q.png");
infospot_muzeu_misc.position.set(2271.14, 1467.2, 4197.08);
infospot_muzeu_misc.addHoverElement(
  document.getElementById("muzeu_misc"),
  -200
);
infospot_muzeu_misc.setCursorHoverStyle("help");

infospot_muzeu_2_marmura = new PANOLENS.Infospot(512, "css/ico/move.png");
infospot_muzeu_2_marmura.position.set(4983.63, -295.53, 90.72);
infospot_muzeu_2_marmura.addHoverText(catre + marmura_name, 80);
infospot_muzeu_2_marmura.addEventListener("click", function () {
  loadPano(panorama_marmura, "marmura");
});
infospot_muzeu_2_marmura.setCursorHoverStyle("pointer");

infospot_marmura_info = new PANOLENS.Infospot(512, "css/ico/info.png");
infospot_marmura_info.position.set(-3754.88, 2234.69, -2416.38);
infospot_marmura_info.addHoverElement(
  document.getElementById("marmura_desc"),
  -200
);
infospot_marmura_info.setCursorHoverStyle("help");

infospot_marmura_2_muzeu = new PANOLENS.Infospot(512, "css/ico/move.png");
infospot_marmura_2_muzeu.position.set(-4866.93, -1081.23, -229.5);
infospot_marmura_2_muzeu.addHoverText(catre + muzeu_name, 80);
infospot_marmura_2_muzeu.addEventListener("click", function () {
  loadPano(panorama_muzeu, "muzeu");
});
infospot_marmura_2_muzeu.setCursorHoverStyle("pointer");

infospot_marmura_misc = new PANOLENS.Infospot(512, "css/ico/q.png");
infospot_marmura_misc.position.set(-3982.95, 2213.72, 2039.64);
infospot_marmura_misc.addHoverElement(
  document.getElementById("marmura_misc"),
  -105
);
infospot_marmura_misc.setCursorHoverStyle("help");

infospot_marmura_2_hol = new PANOLENS.Infospot(512, "css/ico/move.png");
infospot_marmura_2_hol.position.set(4802.75, -1375.96, 4.35);
infospot_marmura_2_hol.addHoverText(catre + hol_name, 80);
infospot_marmura_2_hol.addEventListener("click", function () {
  loadPano(panorama_hol, "hol");
});
infospot_marmura_2_hol.setCursorHoverStyle("pointer");

infospot_hol_info = new PANOLENS.Infospot(512, "css/ico/info.png");
infospot_hol_info.position.set(-3620.09, 525.59, -3397.24);
infospot_hol_info.addHoverElement(document.getElementById("hol_desc"), -150);
infospot_hol_info.setCursorHoverStyle("help");

infospot_hol_2_marmura = new PANOLENS.Infospot(512, "css/ico/move.png");
infospot_hol_2_marmura.position.set(-4933.63, -733.86, -201.01);
infospot_hol_2_marmura.addHoverText(catre + marmura_name, 80);
infospot_hol_2_marmura.addEventListener("click", function () {
  loadPano(panorama_marmura, "marmura");
});
infospot_hol_2_marmura.setCursorHoverStyle("pointer");

infospot_hol_link = new PANOLENS.Infospot(512, "css/ico/info.png");
infospot_hol_link.position.set(119.91, 588.49, 4955.08);
infospot_hol_link.addHoverElement(document.getElementById("hol_link"), 0);
infospot_hol_link.setCursorHoverStyle("pointer");
infospot_hol_link.addEventListener("click", function () {
  setTimeout(function () {
    window.open(hol_link);
  }, 1000);
});

infospot_hol_misc = new PANOLENS.Infospot(512, "css/ico/q.png");
infospot_hol_misc.position.set(-2400.44, 590.08, 4337.347);
infospot_hol_misc.addHoverElement(document.getElementById("hol_misc"), -100);
infospot_hol_misc.setCursorHoverStyle("help");

panorama_muzeu = new PANOLENS.ImagePanorama("img/muzeu.jpg");
panorama_muzeu.addEventListener("progress", onProgress);
panorama_muzeu.addEventListener("leave", onLeave);
panorama_muzeu.addEventListener("enter", onEnter);
panorama_muzeu.addEventListener("load", function () {
  onLoad();
  viewer.tweenControlCenter(new THREE.Vector3(-4964.25, 504.41, -134.84), 0);
  $(".panolens-container canvas").after(
    '<div id="secondary"><span class="item zoom-out"><i class="fa fa-search-minus" aria-hidden="true"></i></span><span class="item zoom-in"><i class="fa fa-search-plus" aria-hidden="true"></i></span><span class="item arrow-right"><i class="fa fa-angle-right" aria-hidden="true"></i></span><span class="item arrow-up"><i class="fa fa-angle-up" aria-hidden="true"></i></span><span class="item arrow-down"><i class="fa fa-angle-down" aria-hidden="true"></i></span><span class="item arrow-left"><i class="fa fa-angle-left" aria-hidden="true"></i></span></div>'
  );
  $("#secondary .zoom-in").on("click touchstart", function () {
    var currentZoom = viewer.camera.fov;
    var newZoom = currentZoom - 10;
    if (newZoom < 30) newZoom = 30;
    viewer.setCameraFov(newZoom);
  });
  $("#secondary .zoom-out").on("click touchstart", function () {
    var currentZoom = viewer.camera.fov;
    var newZoom = currentZoom + 10;
    if (newZoom > 110) newZoom = 110;
    viewer.setCameraFov(newZoom);
  });
  $("#secondary .arrow-left").on("click touchstart", function () {
    RotateLeftRight(1);
  });
  $("#secondary .arrow-right").on("click touchstart", function () {
    RotateLeftRight(0);
  });
  $("#secondary .arrow-up").on("click touchstart", function () {
    rotateUpDown(1);
  });
  $("#secondary .arrow-down").on("click touchstart", function () {
    rotateUpDown(0);
    viewer.OrbitControls.rotateUp(0.1);
  });
  setTimeout(function () {
    $("#intro-msg h1, #intro-msg h2").remove();
    $("#intro-msg img")
      .css("max-width", "50px")
      .css("max-height", "50px")
      .css("margin", "0")
      .css("cursor", "pointer");
    $("#intro-msg")
      .css("width", "50px")
      .css("padding", "0")
      .css("top", "10px")
      .css("left", "10px")
      .css("text-align", "left")
      .css("transform", "none")
      .fadeIn();
  }, 1000);
});

panorama_muzeu.add(infospot_muzeu_info);
panorama_muzeu.add(infospot_muzeu_2_marmura);
panorama_muzeu.add(infospot_muzeu_link);
panorama_muzeu.add(infospot_muzeu_misc);

panorama_marmura = new PANOLENS.ImagePanorama("img/marmura.jpg");
panorama_marmura.addEventListener("progress", onProgress);
panorama_marmura.addEventListener("enter", onEnter);
panorama_marmura.addEventListener("leave", onLeave);
panorama_marmura.addEventListener("load", function () {
  onLoad();
  viewer.tweenControlCenter(new THREE.Vector3(-4986.06, 0.27, -265.77), 0);
});

panorama_marmura.add(infospot_marmura_info);
panorama_marmura.add(infospot_marmura_2_muzeu);
panorama_marmura.add(infospot_marmura_2_hol);
panorama_marmura.add(infospot_marmura_misc);

function showcase(id, x, y, z, dest) {
  window["infospot_" + id];
  window["infospot_" + id] = new PANOLENS.Infospot(512, "css/ico/open.png");
  window["infospot_" + id].position.set(x, y, z);
  window["infospot_" + id].addHoverText(descopera, 80);
  window["infospot_" + id].setCursorHoverStyle("pointer");
  window["infospot_" + id].addEventListener("click", function () {
    $.fancybox.open({
      src: "img/det/" + id + ".jpg",
      opts: {
        caption: cap[id],
        idleTime: 10,
        buttons: ["zoom", "close"],
        lang: lang,
        i18n: fbtrans,
      },
    });
  });
  setTimeout(function () {
    window["panorama_" + dest].add(window["infospot_" + id]);
  }, 1000);
}

function showcaseMulti(id, n, x, y, z, dest) {
  window["infospot_" + id];
  window["infospot_" + id] = new PANOLENS.Infospot(512, "css/ico/open.png");
  window["infospot_" + id].position.set(x, y, z);
  window["infospot_" + id].addHoverText(descopera, 80);
  window["infospot_" + id].setCursorHoverStyle("pointer");
  window["infospot_" + id].addEventListener("click", function () {
    var opts = {
      idleTime: 10,
      buttons: ["zoom", "close"],
      lang: lang,
      i18n: fbtrans,
    };
    var imgs = [];
    for (var i = 1; i <= n; i++) {
      imgs.push({
        src: "img/det/" + id + (n > 1 ? i : "") + ".jpg",
        opts: {
          caption: n > 1 ? cap[id + i] : cap[id],
        },
      });
    }
    $.fancybox.open(imgs, opts);
  });
  setTimeout(function () {
    window["panorama_" + dest].add(window["infospot_" + id]);
  }, 1000);
}

showcaseMulti("p1", 1, -1040.1, -332.56, 4877.08, "marmura");
showcaseMulti("p2", 1, 587.8, -322.77, 4949.47, "marmura");
showcaseMulti("p3", 1, -1516.39, -475.88, 4736.81, "marmura");
showcaseMulti("p4", 1, 1056.2, -490.11, 4858.37, "marmura");
showcaseMulti("p5", 1, 1333.25, -355.92, -4797.59, "marmura");
showcaseMulti("p6", 1, -967.43, -379.06, -4887.1, "marmura");
showcaseMulti("p7", 1, 1006.64, -239.67, -4886.43, "marmura");
showcaseMulti("p8", 1, -551.03, -267.63, -4957.48, "marmura");
showcaseMulti("s1", 1, -2186.24, 66.42, -4487.07, "marmura");
showcaseMulti("s2", 1, -4157.08, 78.88, -2760.79, "marmura");
showcaseMulti("s3", 1, -4479.57, 70.79, 2200.58, "marmura");
showcaseMulti("s4", 1, -2610.91, 26.72, 4256.85, "marmura");

showcaseMulti("t", 5, -728.22, 221.8, -4931.24, "marmura");

panorama_hol = new PANOLENS.ImagePanorama("img/hol.jpg");
panorama_hol.addEventListener("progress", onProgress);
panorama_hol.addEventListener("enter", onEnter);
panorama_hol.addEventListener("leave", onLeave);
panorama_hol.addEventListener("load", function () {
  onLoad();
  viewer.tweenControlCenter(new THREE.Vector3(-4986.06, 0.27, -265.77), 0);
});

panorama_hol.add(infospot_hol_info);
panorama_hol.add(infospot_hol_2_marmura);
panorama_hol.add(infospot_hol_link);
panorama_hol.add(infospot_hol_misc);

viewer = new PANOLENS.Viewer({
  cameraFov: 80,
  output: "console",
  reverseDragging: false,
  controlButtons: ["fullscreen"],
});

viewer.getControl().rotateSpeed *= 2;
viewer.getControl().momentumScalingFactor *= 0.4;
viewer.getCamera().updateProjectionMatrix();

viewer.add(panorama_muzeu);
viewer.add(panorama_marmura);
viewer.add(panorama_hol);

var controlIndex = PANOLENS.Controls.ORBIT;
var controlSensor = {
  style: {
    backgroundImage: "url(css/ico/sensor.png)",
  },
  onTap: function () {
    controlIndex = controlIndex >= 1 ? 0 : controlIndex + 1;
    switch (controlIndex) {
      case 0:
        viewer.enableControl(PANOLENS.Controls.ORBIT);
        break;
      case 1:
        viewer.enableControl(PANOLENS.Controls.DEVICEORIENTATION);
        break;
      default:
        break;
    }
  },
};
var controlRotate = {
  style: {
    backgroundImage: "url(css/ico/rotate.png)",
  },
  onTap: function () {
    var state = viewer.getControl().autoRotate;
    viewer.getControl().autoRotate = !state;
  },
};
var controlMap = {
  style: {
    backgroundImage: "url(css/ico/map.png)",
  },
  onTap: function () {
    $("#map").toggle();
  },
};
var controlExtras = {
  style: {
    backgroundImage: "url(css/ico/extras.png)",
  },
  onTap: function () {
    $("#secondary").toggle(400);
  },
};

viewer.appendControlItem(controlSensor);
viewer.appendControlItem(controlMap);
viewer.appendControlItem(controlRotate);
viewer.appendControlItem(controlExtras);

function loadPano(scene, str) {
  viewer.setPanorama(scene);
  var arr = [];
  try {
    $("svg a").each(function (index, element) {
      arr.push($(this).attr("id").substring(4));
    });
    for (var i = 0; i < arr.length; i++) {
      if (arr[i] == str) {
        $("#svg_" + arr[i])
          .children("circle")
          .css("fill", "#f4792a");
        $("#svg_" + arr[i])
          .children("circle")
          .css("animation", "pulse 2s infinite linear");
      } else {
        $("#svg_" + arr[i])
          .children("circle")
          .css("fill", "#fff");
        $("#svg_" + arr[i])
          .children("circle")
          .css("animation", "none");
      }
    }
  } catch (err) {}
}

function is_touch_device() {
  return "ontouchstart" in window;
}

var ROTATION_POSITION = 0.2;
var ROTATION_SPEED = 150;
function RotateLeftRight(param /* 0 - right, 1 - left */) {
  let go = ROTATION_POSITION;
  let back = -ROTATION_POSITION;
  let pos = param < 1 ? go : back;
  let easing = { val: pos };
  let tween = new TWEEN.Tween(easing)
    .to({ val: 0 }, ROTATION_SPEED)
    .easing(TWEEN.Easing.Quadratic.InOut)
    .onUpdate(function () {
      viewer.OrbitControls.rotateLeft(easing.val);
    })
    .start();
}
function rotateUpDown(param /* 0 - down, 1- up */) {
  let go = ROTATION_POSITION;
  let back = -ROTATION_POSITION;
  let pos = param < 1 ? go : back;
  let easing = { val: pos };
  let tween = new TWEEN.Tween(easing)
    .to({ val: 0 }, ROTATION_SPEED)
    .easing(TWEEN.Easing.Quadratic.InOut)
    .onUpdate(function () {
      viewer.OrbitControls.rotateUp(easing.val);
    })
    .start();
}
